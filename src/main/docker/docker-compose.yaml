#
# Licensed to the Apache Software Foundation (ASF) under one or more
# contributor license agreements.  See the NOTICE file distributed with
# this work for additional information regarding copyright ownership.
# The ASF licenses this file to You under the Apache License, Version 2.0
# (the "License"); you may not use this file except in compliance with
# the License.  You may obtain a copy of the License at
#
#     http://www.apache.org/licenses/LICENSE-2.0
#
# Unless required by applicable law or agreed to in writing, software
# distributed under the License is distributed on an "AS IS" BASIS,
# WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
# See the License for the specific language governing permissions and
# limitations under the License.
#

services:
  rocketmq-dashboard:
    image: 192.168.0.50:5000/application/rocketmq-dashboard:latest
    container_name: rocketmq-dashboard
    environment:
      # 服务端口
      - SERVER_PORT=8200
      # Spring Security 认证配置
      - SPRING_SECURITY_USER_NAME=admin
      - SPRING_SECURITY_USER_PASSWORD=123456
      - SPRING_SECURITY_USER_ROLES=ADMIN
      # RocketMQ NameServer 地址 (多个用分号分隔)
      - ROCKETMQ_CONFIG_NAMESRVADDRS=192.168.0.60:9876;192.168.0.61:9876;192.168.0.62:9876;192.168.0.63:9876;192.168.0.64:9876;192.168.0.65:9876
      # 是否需要登录
      - ROCKETMQ_CONFIG_LOGINREQUIRED=true
      # 认证模式: file 或 acl
      # - ROCKETMQ_CONFIG_AUTHMODE=acl
      # ACL 认证配置
      - ROCKETMQ_CONFIG_ACCESSKEY=application
      - ROCKETMQ_CONFIG_SECRETKEY=123456789
      # Proxy 地址配置
      - ROCKETMQ_CONFIG_PROXYADDR=127.0.0.1:9870
      - ROCKETMQ_CONFIG_PROXYADDRS=192.168.0.60:9870,192.168.0.61:9870,192.168.0.62:9870,192.168.0.63:9870,192.168.0.64:9870,192.168.0.65:9870
      # JVM 参数
      - JAVA_OPTS=-Dfile.encoding=UTF-8 -Xms512m -Xmx512m
      # 外部配置文件目录
      - CONFIG_DIR=/home/rocketmq-dashboard/config
    volumes:
      # 数据目录 (dashboard 监控数据)
      - /home/ygj/rocketmq-dashboard/data:/tmp/rocketmq-console/data:rw
      # 外部配置文件目录 (可选，用于覆盖 JAR 内置配置)
      # 支持的文件: application.yml, logback.xml, role-permission.yml, users.properties, rmqcngkeystore.jks
      - /home/ygj/rocketmq-dashboard/config:/home/rocketmq-dashboard/config:ro
      # 时区同步
      - /etc/localtime:/etc/localtime:ro
      - /etc/timezone:/etc/timezone:ro
    user: root
    restart: always
    network_mode: host
